---
title: c语言中的整形提升
date: 2017-09-02 10:40:52
tags: 随笔
category: c
---
&emsp;&emsp;整型提升是C程序设计语言中的一项规定：在表达式计算时，各种整形首先要提升为int类型，如果int类型不足以表示则要提升为unsigned int类型，然后执行表达式的运算。
<!--more-->
```c
#include<stdio.h>
int main()
{
	char a = -1;
	unsigned char b = -1;
	char c = a + b;
	printf("sizeof(c):%d\n", sizeof(c));
	printf("sizeof(a+b):%d\n", sizeof(a+b));
	printf("a:%d\n", a);
	printf("b:%d\n", b);
	printf("c:%d", c);
	getchar();
	return 0;
}
```
这段代码的执行结果
> sizeof(c):1
> sizeof(a+b):4
> a:-1
> b:255
> c:-2



我们知道有符号数-1的补码为
>11111111 11111111 11111111 11111111

无符号数-1的补码为
>10000000 00000000 00000000 00000001

因为a和b的类型为char,只能存取8个比特位

所以a的二进制为
>11111111

b的二进制为
>00000001

把a按10进制有符号整形的形式输出，仍然是-1.
把b按10进制有符号整形的形式输出,就是255

两个char类型的变量a和b想要进行算数运算，需要进行整形提升为int。

所以a的二进制变为
>11111111 11111111 11111111 11111111

b的二进制变为
>11111111 11111111 11111111 11111111

a和b相加的结果就为
>11111111 11111111 11111111 11111110

所以sizeof(a+b)的值为4，把int型的a+b 的值赋给char类型的c后，由于c只能存取8个比特位，还要发生转换，c中存取的数为
>11111110

也就是-2，sizeof(c)的值为1也不难解释了。